//~ Revision: 371, Copyright (C) 2016-2020: Willem Vree, contributions Stéphane David, Pedro Martínez.
//~ This program is free software; you can redistribute it and/or modify it under the terms of the
//~ GNU General Public License as published by the Free Software Foundation; either version 2 of
//~ the License, or (at your option) any later version.
//~ This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
//~ without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
//~ See the GNU General Public License for more details. <http://www.gnu.org/licenses/gpl.html>.
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(f){var p=0;return function(){return p<f.length?{done:!1,value:f[p++]}:{done:!0}}};$jscomp.arrayIterator=function(f){return{next:$jscomp.arrayIteratorImpl(f)}};$jscomp.makeIterator=function(f){var p="undefined"!=typeof Symbol&&Symbol.iterator&&f[Symbol.iterator];return p?p.call(f):$jscomp.arrayIterator(f)};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(f,p,l){f!=Array.prototype&&f!=Object.prototype&&(f[p]=l.value)};$jscomp.getGlobal=function(f){f=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,f];for(var p=0;p<f.length;++p){var l=f[p];if(l&&l.Math==Math)return l}return globalThis};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(f,p){this.$jscomp$symbol$id_=f;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:p})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function f(l){if(this instanceof f)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(l||"")+"_"+p++,l)}var p=0;return f}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var f=$jscomp.global.Symbol.iterator;f||(f=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[f]&&$jscomp.defineProperty(Array.prototype,f,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var f=$jscomp.global.Symbol.asyncIterator;f||(f=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(f){$jscomp.initSymbolIterator();f={next:f};f[$jscomp.global.Symbol.iterator]=function(){return this};return f};
$jscomp.iteratorFromArray=function(f,p){$jscomp.initSymbolIterator();f instanceof String&&(f+="");var l=0,A={next:function(){if(l<f.length){var z=l++;return{value:p(z,f[z]),done:!1}}A.next=function(){return{done:!0,value:void 0}};return A.next()}};A[Symbol.iterator]=function(){return A};return A};
$jscomp.polyfill=function(f,p,l,A){if(p){l=$jscomp.global;f=f.split(".");for(A=0;A<f.length-1;A++){var z=f[A];z in l||(l[z]={});l=l[z]}f=f[f.length-1];A=l[f];p=p(A);p!=A&&null!=p&&$jscomp.defineProperty(l,f,{configurable:!0,writable:!0,value:p})}};$jscomp.polyfill("Array.prototype.keys",function(f){return f?f:function(){return $jscomp.iteratorFromArray(this,function(f){return f})}},"es6","es3");
$jscomp.checkStringArgs=function(f,p,l){if(null==f)throw new TypeError("The 'this' value for String.prototype."+l+" must not be null or undefined");if(p instanceof RegExp)throw new TypeError("First argument to String.prototype."+l+" must not be a regular expression");return f+""};
$jscomp.polyfill("String.prototype.endsWith",function(f){return f?f:function(f,l){var p=$jscomp.checkStringArgs(this,f,"endsWith");f+="";void 0===l&&(l=p.length);l=Math.max(0,Math.min(l|0,p.length));for(var z=f.length;0<z&&0<l;)if(p[--l]!=f[--z])return!1;return 0>=z}},"es6","es3");
$jscomp.polyfill("Array.from",function(f){return f?f:function(f,l,A){l=null!=l?l:function(f){return f};var p=[],F="undefined"!=typeof Symbol&&Symbol.iterator&&f[Symbol.iterator];if("function"==typeof F){f=F.call(f);for(var da=0;!(F=f.next()).done;)p.push(l.call(A,F.value,da++))}else for(F=f.length,da=0;da<F;da++)p.push(l.call(A,f[da],da));return p}},"es6","es3");
$jscomp.findInternal=function(f,p,l){f instanceof String&&(f=String(f));for(var A=f.length,z=0;z<A;z++){var F=f[z];if(p.call(l,F,z,f))return{i:z,v:F}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(f){return f?f:function(f,l){return $jscomp.findInternal(this,f,l).v}},"es6","es3");$jscomp.polyfill("Math.log10",function(f){return f?f:function(f){return Math.log(f)/Math.LN10}},"es6","es3");
var follow_VERSION=371,pre_opt={},abc_arr,demoDlg,media_file,abc_enc,offset_js,times_arr,opt,lpRec,maat_duren;
(function(){function f(a,b,c){var d=D.createBufferSource();d.buffer=Qc[a];var e=D.createGain();e.gain.setValueAtTime(1E-5,c);b=Vb*b/150;0==b&&(b=1E-5);e.gain.exponentialRampToValueAtTime(b,c+.003);d.connect(e);e.connect(D.destination);d.start(c,.025);Wb[a]=[d,e,b];delete rb[a]}function p(a,b){var c=Wb[a];if(c)if(Xb)rb[a]=1;else{var d=$jscomp.makeIterator(c);c=d.next().value;var e=d.next().value;d=d.next().value;e.gain.setValueAtTime(d,b);e.gain.exponentialRampToValueAtTime(1E-5,b+.1);c.stop(b+.1);
Wb[a]=void 0}}function l(a){var b="C Db D Eb E F Gb G Ab A Bb B".split(" "),c=a.shift();c?(b=MIDI.Soundfont.acoustic_grand_piano[b[c%12]+(Math.floor(c/12)-1)].split(",")[1],Rc(b,function(b){Qc[c]=b;$("#comp").append(", "+c);Yb.push(""+c);Sc[c]=1;l(a)})):(ab=1,u("midi nrs: "+Yb.join(",")),$("#comp").toggle(!1))}function A(a){ab=0;a=Object.keys(a).filter(function(a){return!(a in Sc)});0==X&&(a=[]);a.length?($("#comp").toggle(!0),Yb=[],l(a)):ab=1}function z(a){a=a[0].link;a=a.replace("www.dropbox","dl.dropboxusercontent").split("?")[0];
pre_opt={};sb();R("#wait",1);u("link: "+a);$.get(a,"",null,"text").done(function(a,c){u("preload: "+c);F(a);R("#wait",0)}).fail(function(a,c,d){$("#wait").append("\npreload failed: "+c)})}function F(a){var b=a.slice(0,4E3);0<=b.indexOf("abc_arr = [")?(a=encodeURIComponent(a),tb+=1,Tc("data:text/javascript;charset=utf-8,"+a)):0<=b.indexOf("X:")?(sa(a),Zb()):-1==b.indexOf("<?xml ")?alert("not an xml file nor an abc file"):(a=$.parseXML(a),a=vertaal(a,{p:"f",t:1,u:0,v:3,m:2,mnum:0}),a[1]&&u(a[1]),sa(a[0]),
Zb())}function da(){var a=new FileReader;a.onload=function(b){F(a.result);R("#wait",0)};var b=$("#fknp").prop("files")[0];if(b){var c=b.name.toLowerCase();R("#wait",1);c.endsWith(".ogg")||c.endsWith(".mp3")?(media_file=window.URL.createObjectURL(b),Uc(),R("#wait",0)):(pre_opt={},sb(),a.readAsText(b))}}function sa(a,b){function c(a){var b={diamond:1,triangle:1,square:1,normal:1},c=d,g,e="default",m={"default":[]},w={"default":[]};a=a.split("\n");for(g=0;g<a.length;++g){var k=a[g];if(0<=k.indexOf("I:percmap")){k=
k.split(" ").map(function(a){return a.trim()});var f=k[4];f in b&&(f=f+"+,"+f);k="%%map perc"+e+" "+k[1]+" print="+k[2]+" midi="+k[3]+" heads="+f;m[e].push(k)}0<=k.indexOf("%%MIDI")&&w[e].push(k);0<=k.indexOf("V:")&&(f=k.match(/V:\s*(\S+)/))&&(e=f[1],e in m||(m[e]=[],w[e]=[]))}b=Object.keys(m).sort();for(g=0;g<b.length;++g)c=c.concat(m[b[g]]);e="default";for(g=0;g<a.length;++g)k=a[g],0<=k.indexOf("I:percmap")||0<=k.indexOf("%%MIDI")||(0<=k.indexOf("V:")||0<=k.indexOf("K:")?((f=k.match(/V:\s*(\S+)/))&&
(e=f[1]),c.push(k),e in w&&w[e].length&&(c=c.concat(w[e]),delete w[e]),0<=k.indexOf("perc")&&-1==k.indexOf("map=")&&(k+=" map=perc"),0<=k.indexOf("map=perc")&&0<m[e].length&&c.push("%%voicemap perc"+e),0<=k.indexOf("map=off")&&c.push("%%voicemap")):c.push(k));return c.join("\n")}var d='%%beginsvg\n<defs>,<text id="x" x="-3" y="0">&#xe263;</text>,<text id="x-" x="-3" y="0">&#xe263;</text>,<text id="x+" x="-3" y="0">&#xe263;</text>,<text id="normal" x="-3.7" y="0">&#xe0a3;</text>,<text id="normal-" x="-3.7" y="0">&#xe0a3;</text>,<text id="normal+" x="-3.7" y="0">&#xe0a4;</text>,<g id="circle-x"><text x="-3" y="0">&#xe263;</text><circle r="4" class="stroke"></circle></g>,<g id="circle-x-"><text x="-3" y="0">&#xe263;</text><circle r="4" class="stroke"></circle></g>,<path id="triangle" d="m-4 -3.2l4 6.4 4 -6.4z" class="stroke" style="stroke-width:1.4"></path>,<path id="triangle-" d="m-4 -3.2l4 6.4 4 -6.4z" class="stroke" style="stroke-width:1.4"></path>,<path id="triangle+" d="m-4 -3.2l4 6.4 4 -6.4z" class="stroke" style="fill:#000"></path>,<path id="square" d="m-3.5 3l0 -6.2 7.2 0 0 6.2z" class="stroke" style="stroke-width:1.4"></path>,<path id="square-" d="m-3.5 3l0 -6.2 7.2 0 0 6.2z" class="stroke" style="stroke-width:1.4"></path>,<path id="square+" d="m-3.5 3l0 -6.2 7.2 0 0 6.2z" class="stroke" style="fill:#000"></path>,<path id="diamond" d="m0 -3l4.2 3.2 -4.2 3.2 -4.2 -3.2z" class="stroke" style="stroke-width:1.4"></path>,<path id="diamond-" d="m0 -3l4.2 3.2 -4.2 3.2 -4.2 -3.2z" class="stroke" style="stroke-width:1.4"></path>,<path id="diamond+" d="m0 -3l4.2 3.2 -4.2 3.2 -4.2 -3.2z" class="stroke" style="fill:#000"></path>,</defs>\n%%endsvg'.split(",");
C=a;a=a.split("\n");e.nolyr&&a.splice(1,0,"%%writefields w "+!e.nolyr);0<e.hrz?a.splice(0,0,"%%singleline 1","%%maxshrink "+e.shrnk):a.splice(0,0,"%%measurenb 0");if(e.pw||e.hrz){var m=[],g;for(g=0;g<a.length;++g){var w=a[g];0<=w.indexOf("$")&&(w=w.replace(/\$/g,""));0==w.indexOf("I:linebreak")&&(w=a[g]);0==w.indexOf("V:")&&(w=w.replace(/snm="[^"]*"/,""));0!=w.indexOf("%%page")&&0!=w.indexOf("%%left")&&0!=w.indexOf("%%right")&&(0==w.indexOf("%%scale")&&e.hrz||m.push(w))}a=m;e.hrz?a.splice(1,0,"%%scale "+
e.scl):(m=e.pw,g=(.03*m).toFixed(1),w=(.01*m).toFixed(1),a.splice(1,0,"%%pagewidth "+m+"cm","%%leftmargin "+g+"cm","%%rightmargin "+w+"cm"))}a=a.join("\n");0<=a.indexOf("percmap")&&(a=c(a));Rd(a);$b(a,b)}function Rd(a){function b(a){var b=[];a.forEach(function(a,c){b[a.st]?b[a.st].push(c):b[a.st]=[c];a.clef.clef_octave&&(ub[c]=a.clef.clef_octave);bb[a.st]=6*(a.stafflines||"|||||").length*(a.staffscale||1)});return b}var c="",d=[3,0,4,1,5,2,6],m=[0,2,4,5,7,9,11];Ia=a;fa=[];ub=[];var g=new Abc({img_out:null,
errmsg:function(a,b,d){c+=a+"\n"},read_file:function(a){return""},anno_start:null,get_abcmodel:function(a,c,g){function k(a,b){f[a]=[0,0,0,0,0,0,0];w[a]={};B[a]=b;var c=0<=b;(c?d.slice(0,b):d.slice(b)).forEach(function(b){f[a][b]+=c?1:-1})}var f={};g={"-2":-2,"-1":-1,0:0,1:1,2:2,3:0};var w={},B={},h={},n,q=c[0].meter.a_meter,ea=60,l=384;q=q.length?q[0]:{top:"4",bot:4};for(n=0;n<c.length;++n)k(n,c[n].key.k_sf),h[n]={};vb=c.length;S=b(c);c=0;for(var t=a;t;t=t.ts_next){var p=[];switch(t.type){case 14:l=
t.tempo_notes.reduce(function(a,b){return a+b});ea=t.tempo*l/384;0==t.time&&(c=1);0!=t.time||pre_opt.tempo||(pre_opt.tempo=ea);break;case 10:c||0!=t.time||(pre_opt.tempo&&(ea=pre_opt.tempo),pre_opt.tempo||times_arr||maat_duren||(pre_opt.tempo=ea));var ha={t:t.time,nt:-1,dur:t.dur,nm:"",ntkb:-1};p.push(ha);fa.push({t:t.time,ix:t.istart,v:t.v,dur:t.dur,ns:p,tmp:ea,mtr:q,met:l,st:t.st});break;case 8:c||0!=t.time||(pre_opt.tempo&&(ea=pre_opt.tempo),pre_opt.tempo||times_arr||maat_duren||(pre_opt.tempo=
ea));for(a=0;a<t.notes.length;++a){var v=t.notes[a];var u=v.pit+19;n=t.v;ub[n]&&(u+=ub[n]);ha=Math.floor(u/7);var A=u%7;void 0!=v.acc&&(w[n][u]=g[v.acc]);var x=u in w[n]?w[n][u]:f[n][A];var y=[A,x];var z=12*ha+m[A]+x;ac[z]=1;ha={t:t.time,nt:z,dur:t.dur,nm:y,ntkb:z};u in h[n]?(h[n][u].dur+=t.dur,v.tie_ty||delete h[n][u],ha.nt=-1):v.tie_ty&&(h[n][u]=ha);t.ti2&&t.ti2.notes.filter(function(a){return a.midi==z}).length&&(ha.nt=-1);p.push(ha)}if(0==p.length)break;fa.push({t:t.time,ix:t.istart,v:t.v,dur:t.dur,
ns:p,tmp:ea,mtr:q,met:l,st:t.st});break;case 5:k(t.v,t.k_sf);break;case 0:k(t.v,B[t.v]);fa.push({t:t.time,ix:t.istart,v:t.v,bt:t.bar_type,tx:t.text});break;case 6:q=t.a_meter[0]}}ia.forEach(function(a){var b=a.parentNode;b&&b.removeChild(a)});M=[];for(a=0;a<vb;++a)g=1<<a&0?"0":"",h=document.createElementNS("http://www.w3.org/2000/svg","rect"),h.setAttribute("fill",e.kleur[a%e.kleur.length]+g),h.setAttribute("fill-opacity",e.mat),h.setAttribute("width","0"),ia.push(h),M.push(-1),Ja[a]=[]}});g.tosvg("play",
"%%play");g.tosvg("abc2svg",a);""==c&&(c="no error");u(c)}function $b(a,b){var c="",d="",m=0;q=b||0;M[0]=-1;ja=b||0;ta={};Ka=[];bc={};var g={},f,k,B=1E3,h=0,r=0;if(a){(function(){for(var b=a.split("\n"),c=0;c<b.length&&!(0<=b[c].search(/^%%score/)||0<=b[c].search(/^I:score/));++c);Y&&c==b.length&&(alert("Staff extraction only works with ABC files that have a %%score declaration"),Y=0);if(Y){wb=b[c];Vc=c;var d="("+S[x].map(function(a){return a+1}).join(" ")+")";if(2==Y&&x+1 in S){var g=S[x+1].map(function(a){return a+
1});d="{"+d+"("+g.join(" ")+")}"}b[c]="%%score"+Array(b[c].length-d.length-7+1).join(" ")+d}else wb&&(b[Vc]=wb);a=b.join("\n")})();b={img_out:function(a){-1!=a.indexOf("<svg")&&(Ka[m]=Object.keys(g),g={},m+=1,f<B&&(B=f),k>h&&(h=k),r&&(bc[r]=1),r=0);c+=a},errmsg:function(a,b,c){d+=a+"\n"},read_file:function(a){return""},anno_start:function(a,b,c,d,e,w,B){if("note"==a||"rest"==a)d=l.ax(d).toFixed(2),e=l.ay(e).toFixed(2),B=l.ah(B),ta[b]=[m,d,e,w,B];"bar"==a&&(e=l.ay(e),B=l.ah(B),e=Math.round(e+B),g[e]=
1,k=l.ax(d)+w,f=Math.round(l.ax(0)),b in ta||(ta[b]=[m,k.toFixed(2),e,w,B],r=b))},get_abcmodel:null};0==e.hrz&&(b.imagesize='width="100%"');var l=new Abc(b);l.tosvg("abc2svg",a);""==d&&(d="no error");u(d);c&&($("#notation").html('<div id="leeg" style="height:500px">&nbsp;</div>'),$("#notation").append(c),$("#notation").append('<div id="leeg" style="height:500px">&nbsp;</div>'),$("#leeg").click(function(){Z?ua():J(q)}),T=$("#notation svg"),b=$(".g"),La=b.length?b:T,T.children("title").remove(),Wc(),
Xc(),T.click(function(a){var b,c;a.stopPropagation();var d=(a.clientX+E.scrollLeft)*cb;if(d<B+24||d>h)Z?ua():J(q);else{var g=$("#notation").position().top-$("#notation").scrollTop();var m=T.get().indexOf(this);var k=(a.clientY-g-cc[m])*cb;g=Ka[m];for(a=0;a<g.length&&!U;a++)if(g[a]>k){a!=x&&Ma(Y?x:a);ka(!0);break}for(a=0;a<vb;++a)xb(a);for(c=a=0;a<n.length;++a)if(b=n[a].xy)if(g=b[0],k=b[1],b=b[3],!(g<m&&0==c)){c=1;if(g>m||a==n.length-1){c=a-1;break}if(g==m&&d<parseFloat(k)+b){c=a;break}}e.lus&&U?(d=
c,m=null,U==va&&(q==N&&(q=d),N=d,m=va,e.atagTijd=n[d].t,d>=wa&&(q=d,e.atagTijd=-1)),U==Na&&(wa=d,m=Na,e.btagTijd=n[d].t,d<=N&&(q=d,e.atagTijd=-1)),null!=m&&(m.classList.remove("tagselect"),U=null,dc())):J(c);Oa()}}),Ma(x))}}function Yc(a){a.stopPropagation();a=a.currentTarget;if(U&&(U.classList.remove("tagselect"),a==U)){U=null;return}U=a;a.classList.add("tagselect")}function Sd(a){e.lus&&(a<N||a>wa)&&(a=N);q=ja=a;for(Pa=0;Pa<=q;++Pa)yb(n[Pa],0);ka(!0)}function dc(a){function b(){var a=Object.keys(db).sort(function(a,
b){return a-b}).map(function(a){return 1*a});a.unshift(0);for(var b=0,c=0;b<a.length&&a[b]<=n[q].t;)b+=1;for(;c<n.length&&n[c].t<a[b];)c+=1;return[n[q].t,n[c-1].t]}function c(a){for(var b=0;b<n.length&&!(n[b].t>=a);++b);return b}function d(a,b){var c=$("#chkmod").val(),d=$jscomp.makeIterator(n[b].xy);b=d.next().value;var g=d.next().value;d.next();var e=d.next().value;d.next();d=Ka[b];var m=Y||4==c?0:x,f=m,w=d.length-1;3==c&&(f=Math.min(f+1,w));4==c&&(f=w);g=a==va?g-12:1*g+e;a.setAttribute("x",g);
a.setAttribute("y",d[m]-bb[m]);a.setAttribute("width",12);a.setAttribute("height",d[f]-d[m]+bb[m]);a.style.display="initial";La.eq(b).append(a);a.removeEventListener("click",Yc);a.addEventListener("click",Yc)}a=void 0===a?1:a;if(!(0==n.length||q>n.length)){if(e.lus){if(0>e.atagTijd){var m=$jscomp.makeIterator(b());e.atagTijd=m.next().value;e.btagTijd=m.next().value}N=c(e.atagTijd);wa=c(e.btagTijd);d(va,N);d(Na,wa);Zc(N,wa+1);a&&O(0)}else va.remove(),Na.remove(),Zc(0,n.length-1);Oa(1)}}function Td(){times_arr&&
(maat_duren=times_arr.reduce(function(a,b){return a.concat(b.slice(1))}).map(function(a,b,c){return 0==b?0:Math.round(100*(a-c[b-1]))/100}));var a=Object.keys(db).sort(function(a,b){return a-b}).map(function(a){return 1*a});a.unshift(0);var b,c=0;for(b=1;b<maat_duren.length;++b){var d=a[b]-a[b-1];d=d/384*60/maat_duren[b];for(d=Math.round(100*d)/100;n[c].t<a[b]&&c<n.length;)n[c].tmp=d,c+=1}ec+=offset_js;pre_opt.tempo||(pre_opt.tempo=n[0].tmp)}function Ud(a){function b(a){db[r.t+l]=1;(r.ix in bc||"r"==
a||"v"==a)&&K.push({t:r.t+l,xy:ta[r.ix],bt:a})}n=[];db={};K=[];la=0;var c=$("#chkmod").val(),d=fa.filter(function(b){return!b.bt&&b.v in a}),m=fa.filter(function(b){return b.bt&&b.v in a}),g=d.map(function(a){return a.t});g.push(m[m.length-1].t+1);var f=g.shift(),k=[];d=[];var B=[],h=[];for(m=0;m<fa.length;++m){var r=fa[m];if(r.t==f){for(;r.t==f;)f=g.shift();B.push(h);h=[]}r.t<f&&h.push(r)}B.push(h);f=1;var l=0,p=1,u=0,v=0,A=0,z={};for(m=0;m<B.length;++m)for(h=B[m],d=k,k=[],g=0;g<h.length;++g){r=
h[g];if(r.bt&&0==r.v){":"==r.bt[0]&&1==z[r.t]&&(f=1,z[r.t]=2);if(":"==r.bt[0]&&!z[r.t]){b("r");z[r.t]=1;m=p-1;f=2;l+=r.t-u;k=d;break}":"==r.bt[r.bt.length-1]&&(p=m,u=r.t);v&&(r.tx||"|"!=r.bt)&&(v=0,l-=r.t-A);2==f&&"1"==r.tx&&(b("v"),v=1,A=r.t)}if(v){k=d;break}if(r.bt)b("l");else if(r.v in a||4==c){var x={};var t={};r.ns.sort(function(a,b){return b.nt-a.nt});if(1==c){k=k.concat(r.ns.slice(1));var y=r.ns[0];x[y.nt]=y.nm;t[y.ntkb]=y.nm;y=y.dur}else r.ns.forEach(function(a){x[a.nt]=a.nm;t[a.ntkb]=a.nm}),
y=Math.max.apply(Math,r.ns.map(function(a){return a.dur}));1<Object.keys(x).length&&delete x[-1];n.push({t:r.t+l,xy:ta[r.ix],ptc:x,dur:y,ptckb:t,rst:d,tmp:r.tmp,vce:r.v,mtr:r.mtr,met:r.met,st:r.st});d=k}else r.ns.forEach(function(a){k.push({t:a.t+l,nt:a.nt,dur:a.dur})})}Vd(k);e.audOn&&(times_arr||maat_duren)&&Td();Qa=[];c=ec;B=n[0].t;h=n[0].tmp;for(m=1;m<n.length;++m)Qa.push(c),d=n[m].t,c+=60/h*(d-B)/384,B=d,h=n[m].tmp;m=0<q&&q<n.length?n[q].t:0;for(q=0;q<n.length&&!(n[q].t>=m);++q);q==n.length&&
--q;ja=q;O(0);xa()}function Zc(a,b){for(eb=0;a<b;++a){var c=n[a];-1 in c.ptc||(eb+=Object.keys(c.ptc).length)}}function Vd(a){var b,c=[];fc={};for(b=0;b<n.length;++b){var d=n[b];var e=Object.keys(d.ptc);var g=Object.keys(d.ptckb);e=e.filter(function(a){return-1!=a});g=g.filter(function(a){return-1!=a});var f=e.map(function(a){return{mn:a,dur:d.dur,st:d.st,nm:d.ptc[a]}});if(k&&k.t==d.t)e.forEach(function(a){-1 in k.ptc&&delete k.ptc[-1];k.ptc[a]=d.ptc[a]}),g.forEach(function(a){-1 in k.ptckb&&delete k.ptckb[-1];
k.ptckb[a]=d.ptckb[a]}),k.vxy[d.vce]=d.xy,k.xy||(k.xy=d.xy),d.xy&&1*d.xy[1]<1*k.xy[1]&&(k.xy=d.xy),k.pbk=k.pbk.concat(f),f.forEach(function(a){return k.durs[a.mn]=a.dur}),e.forEach(function(a){k.vcs[a]=d.vce}),k.vms[d.vce]=e,k.vmskb[d.vce]=g,k.nns=Object.keys(k.vcs).length;else{d.pbk=f;d.durs={};f.forEach(function(a){return d.durs[a.mn]=a.dur});d.vxy={};d.vxy[d.vce]=d.xy;d.vcs={};e.forEach(function(a){d.vcs[a]=d.vce});d.vms={};d.vms[d.vce]=e;d.vmskb={};d.vmskb[d.vce]=g;d.nns=Object.keys(d.vcs).length;
var k=d;c.push(d);fc[d.t]=c.length-1}}n=c;b=n[n.length-1];n.push({t:b.t+b.dur,xy:b.xy,ptc:b.ptc,dur:b.dur,rst:a,tmp:b.tmp});ia.forEach(function(a){a.setAttribute("width",0);a.setAttribute("height",0)});if(0<Ra)for(a=0;a<vb;++a)xb(a);(function(){for(var a=[],b=0,c=0;b<n.length&&c<K.length;)n[b].t<K[c].t?(a.push({t:n[b].t,xy:n[b].xy,bt:""}),b+=1):(a.push(K[c]),c+=1);K=a})();n.forEach(function(a,b){return a.iseq=b})}function Wc(){if(0!=T.length){var a=$("#notation").position().top-$("#notation").scrollTop();
cc=T.map(function(b,c){return $(c).position().top-a}).get()}}function Xc(){if(0!=T.length){var a=T.get(0);var b=a.getBoundingClientRect().width;try{var c=a.viewBox.baseVal.width}catch(d){c=b}0==c&&(c=b);a=La.get(0).transform.baseVal;a=a.numberOfItems?a.getItem(0).matrix.a:1;cb=c/a/b}}function ka(a){if(!(0==M.length||0>M[zb])){var b=$("#rollijn").offset().top+30-$("#notation").offset().top,c=Y?0:x;b=Math.round(cc[M[zb]]+(Ka[M[zb]][c]-bb[c])/cb-b);b!=E.scrollTop&&(0<e.hrz?(fb&&(E.style["scroll-behavior"]=
"auto"),E.scrollTop=b):(fb&&(E.style["scroll-behavior"]=a?"smooth":"auto"),fb||!a?E.scrollTop=b:$(E).animate({scrollTop:b})))}}function Wd(a){var b=a.split(",");a=parseInt(b[0]);a=fc[a];if(0<=a){H=b=b[1];var c=156.25/b,d=n[a];yb(d);(e.lncur||e.hrz)&&ya(d.t+.1,c);if(0<X){var m=ma();Object.keys(d.ptc).forEach(function(a){gb(m,a,d.dur*c)});n[a+1].rst.forEach(function(a){gb(m+(a.t-d.t)*c,a.nt,a.dur*c)})}}}function yb(a,b){b=void 0===b?!0:b;var c,d,m,g;zb=a.vce;for(g in a.vxy){var f=ia[g];if(c=a.vxy[g]){var k=
c[0];var h=c[1];var n=c[2];var r=c[3];c=c[4];var l=M[g];k!=l&&((l=f.parentNode)&&l.removeChild(f),La.eq(k).prepend(f),M[g]=k,b&&ka(!0));Ab=1;aa[g]||(aa[g]=e.kleur[g%e.kleur.length]);f.setAttribute("x",h);f.setAttribute("y",n);f.setAttribute("width",r);f.setAttribute("height",c);f.setAttribute("fill",aa[g])}else f.setAttribute("width",0),f.setAttribute("height",0)}gc.value=Math.round(a.tmp*na/(a.met/384));if(0<Ra){for(g in a.vmskb)xb(g);for(g in a.vmskb)a.vmskb[g].forEach(function(b){d=document.getElementById($c[b]);
m=document.getElementById(ad[b]);Ja[g].push([d,m,b]);d.style.fill=e.kleur[g%e.kleur.length];var c=$jscomp.makeIterator(a.ptckb[b]);b=c.next().value;c=c.next().value;m.innerHTML=hc[b]+bd[c+2]})}}function ic(a,b){a.t!=jc&&P.send(a.t+","+b);jc=a.t}function ma(){return 1==X?1E3*D.currentTime:(new Date).getTime()-performance.timing.navigationStart}function Bb(a,b){if(0!=X){if(1==X&&ab){var c=a[0]&240,d=a[2],e=a[1];b/=1E3;128==c&&p(e,b);144==c&&(0<d?f(e,d,b):p(e,b));176==c&&64==e&&(64<=d?Xb=1:(Xb=0,Object.keys(rb).forEach(function(a){p(a,
b)}),rb={}))}2==X&&Cb&&Cb.send(a,b)}}function gb(a,b,c){-1!=b&&(b=[144,b,70],Bb(b,a),b[2]=0,Bb(b,a+c))}function cd(){if(0>oa&&(J(-1),!e.nocnt))return;var a=Q,b=156.25/H,c=ma();if(a.pbk){a.pbk.forEach(function(a){if(-1!=a.mn){var d=[144,a.mn,110];za({data:d});d[2]=0;Bb(d,c+a.dur*b-1)}});for(var d in a.vcs)if(-1!=d){var m=a.vcs[d];aa[m]=e.ntGoed;ia[m].setAttribute("fill",e.ntGoed)}}}function Oa(a,b){if(a){Aa=[];kc=Db=Eb=lc=0;xa();for(var c in ba)ba[c].remove();ba={};Sa={};dd()}b||(oa=-1)}function Xd(a){a=
Aa.map(function(a,b){return[b,a.laat]});var b=Aa.map(function(a,b){return[b+.2,a.duur[0]]}),c=Aa.map(function(a,b){return[b+.4,a.duur[1]||null]}),d=Aa.map(function(a,b){return[b+.6,a.duur[2]||null]});Ta.style.display="block";$.plot("#flot",[{label:"timing",color:"rgba(0,128,0,0.5)",data:a,bars:{show:!0,barWidth:.5,align:"left"},yaxis:1},{label:"duration",color:"#a0522d",data:b,bars:{show:!0,barWidth:.1,align:"left"},yaxis:2},{label:"",color:"#a0522d",data:c,bars:{show:!0,barWidth:.1,align:"left"},
yaxis:2},{label:"",color:"#a0522d",data:d,bars:{show:!0,barWidth:.1,align:"left"},yaxis:2}],{yaxes:[{position:"left",font:{color:"rgba(0,128,0,1)"},min:-500,max:500},{position:"right",font:{color:"#602010"},min:-100,max:100}]})}function ya(a,b,c){function d(a,b){var c=K[la];a<c.t&&(la=0,c=K[0]);for(;a>=c.t;)la+=1,c=K[la];if(b>=c.t){f=1;if(c.t>n[q].t)return b=ya(n[q].t+.1,0,1);if(K[la+1]&&K[la+1].xy[1]<1*c.xy[1])return b=ya(c.t+.1,0,1)}b=K[la-1];var d=(a-b.t)/(c.t-b.t);b=b.xy;a=b[0];b=1*b[1];b+=(1*
c.xy[1]-b)*d;d=g;c=b;if(e.lncur||e.hrz){a!=d&&((h=G.parentNode)&&h.removeChild(G),La.eq(a).prepend(G));var m=Ka[a];d=m[0]-bb[0];m=m[m.length-1]-d;var k=e.oneclr?e.ntWacht:aa[0];G.setAttribute("x",c);G.setAttribute("y",d-6);G.setAttribute("width",2);G.setAttribute("height",m+12);k&&G.setAttribute("fill",k);G.setAttribute("fill-opacity",e.lncur?e.mat:0);e.hide2cur&&e.nocur&&G.setAttribute("fill-opacity",0)}else(h=G.parentNode)&&h.removeChild(G),cancelAnimationFrame(Ua);g=a;0<e.hrz&&(a=b/cb-E.scrollLeft,
E.scrollLeft+=a-E.clientWidth/3)}function m(c){0==l&&(l=c);a+=(c-l)/b;k=a+25/b;d(a,k);l=c;f&&6!=e.volgmod?cancelAnimationFrame(Ua):Ua=requestAnimationFrame(m)}var g=-1,f=0,k,h;cancelAnimationFrame(Ua);var l=0;c?d(a):Ua=requestAnimationFrame(m)}function O(a,b,c){q+=a;0>q&&(q=0);L=0<q&&!c?n[q-1]:n[q];var d=n[q],m=ma(),g=H;mc=H;c=(m-nc)/oc;a&&!pc&&Va&&c<hb&&c>qc&&(g=Math.round(g/(1<=c?1+.5*(c-1):1-.5*(1-c))),H=g=ib>g?ib:g,na=g/L.tmp,y.playbackRate=na);var f=156.25/g,k=ed=f,l=L.t,p=(d.t-l)*f;L.tmp!=d.tmp&&
(H=d.tmp*na,k=156.25/H);var r=d.dur*k;c=1;var u=p;if(a&&pa&&!y.ended){y.paused&&Fb(-1);var v=y.currentTime-Qa[q-1];h.lat&&$("#deb").html((1E3*v).toFixed(0)+" msec");Va||(p-=1E3*v,0>p&&(p=0),c=p/u,.3>c&&(c=.3));clearTimeout(fd);fd=setTimeout(function(){y.pause()},p+e.tmo)}var x=-1;!a&&!b||e.rstmute||d.rst.forEach(function(a){var b=(a.t-l)*f;gb(m+b,a.nt,a.dur*f);Wa&&b!=x&&(x=b,setTimeout(function(){ic(a,g)},b))});if(q==n.length-1)gd=setTimeout(function(){for(var a in I)rc(Q,a,I[a]);J(-1)},p),(e.lncur||
e.hrz)&&ya(l,f*c);else{if(e.lus&&(q>wa||q<N)){if(e.lusstop&&a){setTimeout(function(){J(-1)},p);return}N<n.length&&(q=ja=N,d=n[q],setTimeout(function(){Oa(1,1);pa&&Gb&&Fb()},p))}pc=1==a&&-1 in d.ptc;jb||pc?(e.mute||d.pbk.forEach(function(a){gb(m+p,a.mn,a.dur*k)}),clearTimeout(kb),kb=setTimeout(function(){O(1)},p)):Hb&&a&&(b=(d.t-l)*Yd,clearTimeout(kb),kb=setTimeout(function(){O(1)},b));b=p>r?.5*r:.5*p;e.exact&&Ib&&(b=0);b=p-b;var z=hd?p-b:0;0==a?(qa={},I={},Q=d,aa={},lb||(ca={}),Sd(q),pa&&(y.currentTime=
Qa[q]),L=d,(e.lncur||e.hrz)&&ya(d.t+.1,f,1),Wa&&(ic(d,g),jc=-1)):((e.lncur||e.hrz)&&ya(l,f*c),id=setTimeout(function(){if(jb)for(var a in Q.vcs)a in qa||-1==a||(I[Q.vcs[a]]=1);for(var b in I)rc(Q,b,I[b]);I={};qa={};Q=d;aa={};Ab=0;oa=m+p;clearTimeout(sc);sc=setTimeout(function(){yb(d);for(var a in ca)tc(a,1);ca={}},z)},b),Wa&&(jd=setTimeout(function(){ic(d,g)},p)));nc=m;oc=p;Ba&&(l in db||0==l)&&uc(1)}}function kd(){clearTimeout(kb);clearTimeout(id);clearTimeout(sc);clearTimeout(jd);clearTimeout(gd);
cancelAnimationFrame(Ua)}function Fb(a){y.currentTime=Qa[q+(void 0===a?0:a)];y.play()}function J(a,b){function c(a){y.removeEventListener("canplaythrough",c);u("sufficient audio data loaded");y.pause();y.currentTime=Qa[0];R("#unlkDlg",0);pa=1;ld(b)}b=void 0===b?!0:b;n.length&&("stop"==Ca.value||0<=a?(Ca.value="start",Gb=0,md(),jb=0,kd(),oa=-1,ja=q=0<=a?a:ja,O(0,0,1),e.ftyp&&nd(),0>a&&window.parent.postMessage(od.innerHTML,"*")):(Ca.value="stop",H=L.tmp*na,y.playbackRate=na,mc=H,"running"!=D.state&&
D.resume().then(function(){u("audio context now running")}),Jb&&4>y.readyState?(oa=0,y.addEventListener("canplaythrough",c),R("#unlkDlg",1),Fb()):(Jb&&(pa=1),ld(b))))}function Zd(a){var b=a.key;"Escape"==b&&("block"==Ta.style.display?Ta.style.display="none":ua());if(!Z||"m"==b)switch(b){case "ArrowLeft":case "Left":O(-1);break;case "ArrowUp":case "Up":pd(-1);break;case "ArrowRight":case "Right":cd();break;case " ":a.preventDefault();cd();break;case "ArrowDown":case "Down":pd(1);break;case "c":J(-1);
break;case "m":$("#mbar").click()}}function $d(){function a(a){if("#"!=a[0])return a;var b=parseInt(a[1]+a[1],16),d=parseInt(a[2]+a[2],16);a=parseInt(a[3]+a[3],16);return"rgba("+b+","+d+","+a+","+e.mat+")"}Da={};e.ntKleur.forEach(function(a,c){Da[c+1]=a});vc=document.getElementById("sgd");wc=document.getElementById("se1");xc=document.getElementById("se2");yc=document.getElementById("se3");zc=document.getElementById("pct");qd=document.getElementById("stot");wc.style.background=a(Da[1]);xc.style.background=
a(Da[2]);yc.style.background=a(Da[4]);xa()}function xa(){if(eb&&vc){var a=kc*e.pnlerr,b=Eb*e.pnltim,c=lc*e.pnlkrt,d=100*(Db-a-(e.tmng?b:0)-(e.tmng2?c:0))/eb;0>d&&(d=0);var f=$jscomp.makeIterator(["rgba(255,0,0,0.3)","rgba(0,191,255,0.5)","rgba(0,255,0,0.5)"]),g=f.next().value,h=f.next().value;f=f.next().value;var k=d.toFixed(0);e.scal&&(vc.innerHTML=Db,wc.innerHTML=a,xc.innerHTML=b,yc.innerHTML=c,qd.innerHTML=eb);zc.innerHTML=k;zc.style.background=50>d?g:85>d?h:f;e.lus?localStorage.setItem("loopscore",
k):localStorage.setItem("score",k)}}function ae(a){var b=Ac[a]-oa,c=Math.abs(b);e.tmng&&c>e.late1&&(Eb+=1,c>e.late2&&(Eb+=1),a=Q.vcs[a],I[a]=(I[a]||0)|2);Aa[Q.iseq]={laat:b,duur:[]}}function tc(a,b){var c=Q;if(c){b||(Ac[a]=ma());Object.keys(c.ptc);if(0>oa&&(60==a||a in c.ptc)){if(1==V){ca[a]=1;return}J(-1,60==a);if(!e.nocnt&&60==a||-1 in c.ptc)return}if(Gb)if(a==e.stopat)J(-1);else if(Object.keys(qa).length==c.nns||-1 in c.ptc)ca[a]=1;else{if(a in c.vcs)qa[a]=1,Kb[a]=c,b=c.vcs[a],c.vms[b].every(function(a){return a in
qa})&&(aa[b]=e.ntGoed,Ab&&ia[b].setAttribute("fill",e.ntGoed),ae(a));else{kc+=1;xa();for(var d in c.vcs)d in qa||-1==d||(b=c.vcs[d],aa[b]=e.ntFout,I[b]=(I[b]||0)|1,Ab&&ia[b].setAttribute("fill",e.ntFout))}Object.keys(qa).length==c.nns&&(Db+=c.pbk.length,xa(),jb||O(1))}}}function rd(a){if(e.tmng2&&Kb[a]){var b=Kb[a],c=b.durs[a]*ed,d=Ac[a]+c-ma();c=100*d/c;delete Kb[a];if((0>c?-c:c)>e.kort&&(0>d?-d:d)>e.minkort)if(lc+=1,xa(),a=b.vcs[a],b.iseq==Q.iseq)I[a]=(I[a]||0)|4;else{d=b.iseq+","+a;var f=ba[d];
f?(Sa[d]|=4,f.setAttribute("fill",Da[Sa[d]])):rc(b,a,4)}(b=Aa[b.iseq])&&b.duur.push(c)}}function rc(a,b,c){if(-1 in a.ptc)console.log("rust fout",a.iseq,b,c);else{var d=a.iseq+","+b,f=a.vxy[b];if(f){a=f[0];b=f[1];var g=f[2],h=f[3];f=f[4];var k=document.createElementNS("http://www.w3.org/2000/svg","rect");k.setAttribute("x",b);k.setAttribute("y",g);k.setAttribute("width",h);k.setAttribute("height",f);k.setAttribute("fill",Da[c]);k.setAttribute("fill-opacity",e.metmrk?e.mat:0);La.eq(a).prepend(k);ba[d]=
k;Sa[d]=c}}}function nd(){for(var a in ba){var b=Sa[a],c=ba[a],d=$jscomp.makeIterator(a.split(",")),e=d.next().value;d=d.next().value;var g=$jscomp.makeIterator(n[e].vxy[d].map(function(a){return 1*a}));g.next();e=g.next().value;d=g.next().value;var f=g.next().value,k=g.next().value;g=document.createElementNS("http://www.w3.org/2000/svg","text");g.setAttribute("x",e+f);g.setAttribute("y",d+k);g.setAttribute("font-size","12");g.setAttribute("class","tfout");b=document.createTextNode(b);g.appendChild(b);
c.parentElement.append(g)}}function dd(){var a=document.getElementsByClassName("tfout");Array.from(a).forEach(function(a){return a.remove()})}function sd(){for(var a=ma(),b=0;3>b;++b)gb(a,60+2*b,300),a+=310}function za(a){var b=a.data[0],c=a.data[1],d=a.data[2];254!=b&&(b&=240,128==b&&(delete ca[c],rd(c)),144==b&&(0<d?tc(c):(delete ca[c],rd(c))),e.echo&&Bb(a.data,ma()))}function be(a){u("MIDI ready! Listening to following input ports:");var b=0;a.inputs.forEach(function(a){a.onmidimessage=za;u(b+
": "+a.name+', "'+a.manufacturer+'"');b++});u("The following output ports are present:");var c=$("#portsel");a=a.outputs;b=0;a.forEach(function(a){u(b+": "+a.name+', "'+a.manufacturer+'"');c.append('<option value="'+b+'">'+a.name+"</option>");td.push(a);Cb=a;b++})}function ce(a){u("Failed to get MIDI access - "+a)}function de(a){var b=$("#portsel").val();"synth"==b?(X=1,a&&A(ac)):"nosound"==b?X=0:(X=2,a=parseInt(b),Cb=td[a]);sd()}function Ma(a){a in S||(a=0);kd();var b={};S[a].forEach(function(a){b[a]=
1});if(3==$("#chkmod").val()){var c=a;a+1 in S?c=a+1:a-1 in S&&(a=c=a-1);S[c].forEach(function(a){b[a]=1})}M.forEach(function(a,b,c){c[b]=-1});Ia&&Ud(b);x=a;dc(0)}function pd(a){x+=a;0>x&&(x=0);x>=S.length&&(x=0);Ma(x)}function ua(){Z=0;$("#menu").toggle(!1);$(".down").toggleClass("down",!1)}function Bc(a){Z==a?ua():(ua(),Z=a,$("#menu").toggle(!0),$("#hfd div").toggle(!1),$("#hfd div:nth-child("+a+")").toggle(!0),$("#btns > div > div:nth-child("+a+")").toggleClass("down",!0),$("#btns > #mbar").toggleClass("down",
!0))}function ud(){Cc.style.fill="none";if(Ba||V)Lb=setTimeout(uc,Dc)}function md(){V=0;lb=Ba=!1;clearTimeout(Lb);$("#countin").toggle(!1);ud();pa&&y.pause()}function ld(a){var b={"2/2":2,"3/2":3,"4/2":4,"2/4":2,"3/4":3,"4/4":4,"5/4":5,"6/8":2,"7/8":3,"9/8":3,"11/8":4,"12/8":4};$("#start").blur();if(Ba||V)md();else{Oa(1);var c=L.mtr.top+"/"+L.mtr.bot;V=a&&!e.nocnt?b[c]+1:1;lb=6==e.volgmod;$("#countin").html("<b>"+V+"</b>").toggle(!0);uc()}}function uc(a){Cc.style.fill="red";var b=D.createBufferSource();
b.buffer=vd;var c=D.createGain();c.gain.setValueAtTime(a?3:1,0);b.connect(c);c.connect(D.destination);b.start(0,.06,.16);Dc=3E4/mc*(L.met/384);clearTimeout(Lb);Lb=setTimeout(ud,Dc);if(0<V&&(--V,$("#countin").html("<b>"+V+"</b>"),0==V)){$("#countin").toggle(!1);Gb=1;Ba=e.metro;nc=oa=ma();lb?(jb=1,pa&&Fb(),O(0,0,1),lb=0):e.eenvoor?O(0,1):(oc=0,-1 in n[q].ptc&&O(1));for(var d in ca)tc(d,1);ca={}}}function Rc(a,b){a=atob(a);for(var c=new ArrayBuffer(a.length),d=new Uint8Array(c),e=0;e<a.length;e++)d[e]=
a.charCodeAt(e);D.decodeAudioData(c,function(a){b(a)},function(a){console.log("decode error: "+a);ab=0})}function wd(a){e.audOn=a;$("#spkron").toggle(a);$("#spkrof").toggle(!a);y.muted=!a;C&&Ma(x)}function ee(){var a="",b="",c,d,e="";var g=window.location.href.replace("?dl=0","").split("?");if(c=g[0].match(/:\/\/([^/:]+)/))var f=c[1];if(1<g.length){var k=g[1].split("&");for(d=0;d<k.length;d++)g=k[d].replace(/d:(\w{15}\/[^.]+\.)/,"https://dl.dropboxusercontent.com/s/$1"),(c=g.match(/tmp=([\d.]*)/))?
h.tempo=parseFloat(c[1]):(c=g.match(/stf=(\d+)/))?h.staff=parseInt(c[1]):(c=g.match(/mod=(\d+)/))?h.chkmod=parseInt(c[1]):(c=g.match(/fmd=(\d+)/))?h.volgmod=parseInt(c[1]):(c=g.match(/opa=(\d)/))?h.kbopa=parseInt(c[1]):(c=g.match(/line=(\d+)/))?h.line=parseInt(c[1]):(c=g.match(/pw=(\d+)/))?h.pw=parseInt(c[1]):(c=g.match(/scl=([\d.]*)/))?h.scl=parseFloat(c[1]):(c=g.match(/hrz=(\d+)/))?h.hrz=parseInt(c[1]):(c=g.match(/tb=([\d.]*)/))?h.btime=parseFloat(c[1]):(c=g.match(/te=([\d.]*)/))?h.etime=parseFloat(c[1]):
(c=g.match(/begin=([\d]+)/))?h.begin=parseInt(c[1]):(c=g.match(/shrnk=([\d.]*)/))?h.shrnk=parseFloat(c[1]):(c=g.match(/lat=([+-]?[\d]+)/))?h.lat=parseInt(c[1]):(c=g.match(/vol=([\d]*)/))?h.vol=parseInt(c[1]):(c=g.match(/pnlerr=([\d.]*)/))?h.pnlerr=parseFloat(c[1]):(c=g.match(/pnltim=([\d.]*)/))?h.pnltim=parseFloat(c[1]):(c=g.match(/pnlkrt=([\d.]*)/))?h.pnlkrt=parseFloat(c[1]):(c=g.match(/late1=([\d]*)/))?h.late1=parseInt(c[1]):(c=g.match(/late2=([\d]*)/))?h.late2=parseInt(c[1]):(c=g.match(/kort=([\d]*)/))?
h.kort=parseInt(c[1]):(c=g.match(/minkort=([\d]*)/))?h.minkort=parseInt(c[1]):(c=g.match(/stopat=([\d]*)/))?h.stopat=parseInt(c[1]):(c=g.match(/hinfo=(\d+)/))?h.hinfo=parseInt(c[1]):(c=g.match(/mat=([\d.]+)/))?h.mat=parseFloat(c[1]):(c=g.match(/kleur=([#\dabcdef,]+)/))?h.kleur=c[1].split(","):(c=g.match(/tmo=(\d+)/))?h.tmo=parseInt(c[1]):"ip"==g&&f?h.ipadr=f:"ipm"==g&&f?(h.ipadr=f,h.mstr=1):"metro"==g?h.metro=1:"nocnt"==g?h.nocnt=1:"nodel"==g?h.delay=0:"keyb"==g?h.keys=1:"ksh"==g?h.mark=1:"nosnd"==
g?h.portsel="nosound":"nobar"==g?h.nobar=1:"nomenu"==g?h.nomenu=1:"extr"==g?h.extract=2:"extrg"==g?h.extract=3:"nocur"==g?h.nocur=1:"mute"==g?h.mute=1:"rstmute"==g?h.rstmute=1:"nosm"==g?fb=!1:"ctrls"==g?h.ctrls=1:"tmng"==g?h.tmng=1:"tmng2"==g?h.tmng2=1:"lncur"==g?h.lncur=1:"oneclr"==g?h.oneclr=1:"nolyr"==g?h.nolyr=1:"hide2cur"==g?h.hide2cur=1:"metmrk"==g?h.metmrk=1:"ftyp"==g?h.ftyp=1:"scal"==g?h.scal=1:"noecho"==g?h.echo=0:b=g,/(\.xml$)|(\.abc$)/.test(b)&&(a=b,b=""),/(\.mp3$)|(\.mp4$)|(\.ogg$)|(\.webm$)/.test(b)&&
(e=b,b="");e&&(media_file=decodeURIComponent(e).replace("www.dropbox","dl.dropboxusercontent"));(b||a)&&R("#wait",1);a?$.get(a,"",null,"text").done(function(a,b){u("preload: "+b);F(a);R("#wait",0)}).fail(function(a,b,c){$("#wait").append("\npreload failed: "+b)}):b&&Tc(b)}return b||a}function Tc(a){0<=a.indexOf("dropbox.com")&&(a+="?dl=1");0!=a.indexOf("data:text")&&-1==a.indexOf("http")&&(a="./"+a);import(a).then(function(a){u("preload loaded");if(a.pre_opt){media_file=a.media_file;pre_opt=a.pre_opt;
abc_arr=a.abc_arr;for(var b in a.defaults)b in pre_opt||(pre_opt[b]=a.defaults[b])}sb();F(abc_arr.join("\n"));R("#wait",0,!P||h.mstr)}).catch(function(a){$("#wait,#err").append("\npreload failed:\n"+a)})}function Mb(a,b){var c=document.getElementById(a),d=c?c.type:void 0;void 0!=b&&(e[a]=b);"checkbox"==d&&(c.checked=e[a]);if("number"==d||"select-one"==d)c.value=e[a];void 0!=b&&Ea(a)}function Zb(){for(var a in pre_opt)e[a]=pre_opt[a];for(a in h)e[a]=h[a];for(a in Nb)Mb(a);for(a in e)Ea(a,0);Jb=pa=
0;ec=e.lat/1E3;Uc();mb.addEventListener("change",function(){mb.blur();e.vol=mb.value;Vb=e.vol/25});mb.value=e.vol;Vb=e.vol/25;A(ac);Ia&&(e.pw||e.hrz||e.nolyr?sa(C,q):$b(Ia,q),Ea("begin",1));h.ipadr&&(fe(h.ipadr),h.mstr||T.off());demoDlg&&($("#demoDlg span").html(demoDlg),$("#demoDlg").toggle(!0),$("#demoDlg button").on("mouseup touchend keydown blur",function(a){a.stopPropagation();$("#demoDlg").toggle(!1);$("#demoDlg button").off("mouseup touchend keydown blur")}).focus());$d()}function Uc(){media_file&&
(y.src=media_file,e.ctrls&&(y.controls=!0),Jb=1,$("#spkr").toggle(!0));xd=media_file||""}function ge(){if(C){var a='media_file = "'+(xd||"")+'";\n',b="",c="",d=[];if(maat_duren){for(b="offset_js = "+offset_js.toFixed(2)+";\n";maat_duren.length;)d.push(maat_duren.splice(0,10).toString());c="maat_duren = ["+d.join(",\n")+"];\n"}d=C.split("\n").map(function(a){return JSON.stringify(a)});d="abc_arr = ["+d.join(",\n")+"];\n";e.staff=x+1;e.line=Math.round(100*$("#rollijn").position().top/$("body").height());
e.begin=ja;for(var f=("pre_opt = "+JSON.stringify(e)+";").split(","),g=[],h="";f.length;){for(;80>h.length&&f.length;)h+=f.splice(0,1)+",";g.push(h);h=""}g=g.join("\n").replace(/,$/,"\n");a=a+b+g+c+d;b="data:text/plain;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(a)));$("#saveDlg pre").text(a);$("#saveDlg").toggle(!0);$("#div3 a").attr("href",b);$("#saveok").focus()}}function he(a){Hb=!1;ib=0;$("#mtplab").toggle(!1);Va=1;hb=Hb?10:3;qc=1/hb;e.volgmod=$("#volgmod").val();switch(e.volgmod){case "5":$("#mtplab").toggle(!0);
ib=e.mtpo;break;case "6":Va=0;break;case "7":Va=0}a&&Mb("delay",!Va);Oa()}function yd(){na=L?H/L.tmp:1;y.playbackRate=na}function ie(a){a.stopPropagation();a.preventDefault();a.target.style.fill="red";a=Ec[a.target.id];Fc[a]=1;za({data:[144,a,110]})}function zd(a){a.stopPropagation();a.preventDefault();var b=Ec[a.target.id];b in Fc&&(delete Fc[b],za({data:[144,b,0]}),a.target.style.fill=Gc(b))}function Gc(a){return a%12 in Ad?"black":60==a?"#9cc":"white"}function je(){Ad={1:1,3:1,6:1,8:1,10:1};for(var a=
[0,2,4,5,7,9,11,1,3,6,8,10],b=[],c=0;8>c;++c)for(var d=0;12>d;++d)b.push(12*c+a[d]+12);a=$("#toetsen rect");for(d=0;d<a.length;++d)c=$(a[d]),Ec[a[d].id]=b[d],$c[b[d]]=a[d].id,c.on("mousedown touchstart",ie),c.on("mouseup touchend",zd),c.on("mouseleave",zd),a[d].style.fill=Gc(b[d]);a=$("#toetsen text");for(d=0;d<a.length;++d)ad[b[d]]=a[d].id}function Bd(){var a=$("#toetsen")[0].scrollWidth-$("body").width();$("#keyb").scrollLeft(a/2)}function Fa(){var a=W&&0==Hc?$("#keyb").height():$("#err").height(),
b=$("body").height(),c=$("#info").height();c=Math.round(100*c/b);a=Math.round(100*a/b);$("#notation").css("height",100-c-a+"%")}function Cd(a){var b=$("#toetsen svg"),c=b.width();c=100*c/$("body").width();b.css("width",c+a+"%");Bd()}function ke(){for(var a=$("#octaaf"),b=0;8>b;++b){var c=a.clone();c.find("rect").each(function(a,c){c.id+="-"+b});c.find("text").each(function(a,c){c.id+="-"+b});$("#toetsen").append(c)}je()}function le(a){if(W&&"zoom"==a.target.id){a.stopPropagation();a.preventDefault();
var b="touchstart"==a.type,c=$("#zoom"),d=b?a.originalEvent.touches[0].clientX:a.pageX,e=b?a.originalEvent.touches[0].clientY:a.pageY,g=$("#keyb").height(),f=$("#keyb").scrollLeft();c.css("cursor","row-resize").toggleClass("spel",!0);c.on("mousemove touchmove",function(a){a.stopPropagation();a.preventDefault();var c=b?a.originalEvent.touches[0].clientX:a.clientX;a=b?a.originalEvent.touches[0].clientY:a.clientY;Math.abs(a-e)>Math.abs(c-d)?(c=g+e-a,a=$("body").height(),c=Math.floor(100*c/a),$("#keyb").css("height",
c+"%"),$("#zoom").css("bottom",c+"%"),$("#kblft").css("bottom",c+"%"),$("#kbrgt").css("bottom",c+"%")):$("#keyb").scrollLeft(f+d-c)});c.on("mouseup touchend mouseleave",function(a){a.stopPropagation();a.preventDefault();c.css("cursor","initial").toggleClass("spel",!1);c.off("mousemove touchmove mouseup touchend mouseleave");Fa()})}}function me(a){if("info"==a.target.id||"error"==a.target.id||""==a.target.id){a.stopPropagation();a.preventDefault();var b="touchstart"==a.type,c=$("#info"),d=b?a.originalEvent.touches[0].clientY:
a.pageY,f=c.height();$("#notation").height();c.css("cursor","row-resize").toggleClass("spel",!0);c.on("mousemove touchmove",function(a){a.stopPropagation();a.preventDefault();var g=$("body").height();a=f+(b?a.originalEvent.touches[0].clientY:a.clientY)-d;c.css("height",Math.floor(100*a/g)+"%");e.hinfo=a;Fa()});c.on("mouseup touchend mouseleave",function(a){a.stopPropagation();a.preventDefault();c.css("cursor","initial").toggleClass("spel",!1);c.off("mousemove touchmove mouseup touchend mouseleave");
Fa();ka()})}}function ne(a){bd=["&#9837;&#9837;","&#9837;","","&#9839;","&#9839;&#9839;"].map(function(a){return'<tspan dy="-5">x</tspan>'.replace("x",a)});for(var b=document.querySelectorAll("#toetsen text"),c=0;c<b.length;++c)b[c].setAttribute("dx",2==a?-3:0);1==Ra?hc="CDEFGAB".split(""):2==Ra&&(hc="Do Re Mi Fa So La Ti".split(" "))}function xb(a){Ja[a]&&(Ja[a].forEach(function(a){var b=$jscomp.makeIterator(a);a=b.next().value;var d=b.next().value;b=b.next().value;a.style.fill=Gc(b);d.innerHTML=
""}),Ja[a]=[])}function Dd(a){function b(){d&&(Cd(c?-1:1),setTimeout(b,200))}var c=0,d=0;a=$(a);a.on("mousedown touchstart",function(a){a.stopPropagation();a.preventDefault();a.currentTarget.children[1].style.fill="red";c="kblft"==a.currentTarget.id;d=1;b()});a.on("mouseup touchend mouseleave",function(a){a.stopPropagation();a.preventDefault();d&&(a.currentTarget.children[1].style.fill="rgba(0,255,0,0.3)",d=0)})}function oe(a){a.preventDefault();var b="touchstart"==a.type,c=$("#rollijn");c.css("cursor",
"row-resize").toggleClass("spel",!0);c.on("mousemove touchmove",function(a){$("#notation").offset();a=b?a.originalEvent.touches[0].clientY:a.clientY;$("#rollijn").css("top",a-15+"px");ka()});c.on("mouseup touchend mouseleave",function(a){c.off("mousemove touchmove mouseup touchend mouseleave");c.css("cursor","initial").toggleClass("spel",!1)})}function u(a,b){b||(a+="\n");$("#err").append(a)}function fe(a){P?u("websocket already open"):(P=new WebSocket("ws://"+a+":8091/"),P.onmessage=function(a){a=
a.data;"master"==a?($("#mbar").css("background","rgba(255,0,0,0.2)"),Wa=1):Wa||Wd(a)},P.onerror=function(a){u("socket error (server inaccessible?)");P=null},P.onopen=function(a){$("#mbar").css("background","rgba(0,255,0,0.2)");h.mstr&&P.send("master");u("connection opened")},P.onclose=function(a){$("#mbar").css("background","");u("connection closed: "+a.code);P=null;Wa=0})}function sb(){e={};Ia="";for(var a in Nb)e[a]=Nb[a];for(a in Ed)e[a]=Ed[a];for(a in Nb)Mb(a);for(a in e)Ea(a,0)}function Ea(a,
b,c){switch(a){case "tempo":H=e.tempo;yd();break;case "mtpo":ib=e.mtpo;break;case "chkmod":C&&b&&Ma(x);break;case "delay":hd=e[a];break;case "exact":Ib=6!=e.volgmod;if(a=document.getElementById("exact"))a.disabled=!Ib;if(a=document.getElementById("delay"))a.disabled=e.exact&&Ib;break;case "volgmod":he(c);Ea("exact");break;case "portsel":de(c);break;case "keys":W=$("#keys").prop("checked");$("#marklbl").toggle(W);$("#keyb").toggle(W);$("#zoom").toggle(W);$("#kblft").toggle(W);$("#kbrgt").toggle(W);
$("#rek").toggle(W);W?Cd(0):Bd();Fa();break;case "mark":Ra=e[a];ne(Ra);for(var d in Ja)xb(d);n.length&&yb(n[q]);break;case "kbopa":Hc=e[a]/10;$("#keyb").css("opacity",1-Hc);Fa();break;case "hinfo":a=$("body").height();a=Math.floor(100*e.hinfo/a);$("#info").css("height",a+"%");Fa();break;case "pw":e.pw=parseFloat(e[a]);5>e.pw&&(delete e.pw,$("#pw").val(""));C&&b&&sa(C);break;case "scl":e.scl=parseFloat(e[a]);if(.1>e.scl||2<e.scl)delete e.scl,$("#scl").val("");C&&b&&sa(C);break;case "nolyr":C&&b&&sa(C,
q);break;case "lus":b&&dc();$("#stoplbl").toggle(!!e.lus);break;case "metro":Ba&&(Ba=!1);break;case "extract":Y=e.extract-1;0==Y&&(wb="");C&&b&&$b(Ia);break;case "micuse":e.micuse?pe():Ic();break;case "audOn":wd(e.audOn);case "gain":Fd();break;case "drempel":qe();break;case "minlev":Gd();case "bass":Xa=$("#bass").prop("checked")?1024:512;Ga&&Hd();break;case "staff":x=e.staff-1;C&&b&&Ma(x);break;case "line":$("#rollijn").css("top",e.line+"%");ka();break;case "begin":q=ja=e.begin;C&&b&&O(0);break;case "lncur":C&&
e.lncur&&ya(n[q].t+.1,0,1);e.lncur||G.setAttribute("fill-opacity",0);break;case "nocur":ia.forEach(function(a){return a.setAttribute("fill-opacity",e.nocur?0:e.mat)});e.hide2cur&&G.setAttribute("fill-opacity",e.nocur?0:e.lncur?e.mat:0);break;case "metmrk":for(var f in ba)ba[f].setAttribute("fill-opacity",e.metmrk?e.mat:0);break;case "drpuse":re();break;case "nobar":$("#info").toggle(!1);$("#err").toggle(!1);$("#notation").css("height","100%");ka();break;case "nomenu":$("#btns").toggle(!1);break;case "hrz":b&&
(e.hrz=e.hrz?50:0);$("#pwlbl").toggle(0==e.hrz);$("#scllbl").toggle(0<e.hrz);C&&b&&sa(C);break;case "tmng":case "tmng2":case "scal":$("#sgd").parent().toggle(!!e.scal);$("#se2").parent().toggle(!(!e.tmng||!e.scal));$("#se3").parent().toggle(!(!e.tmng2||!e.scal));$("#stot").parent().toggle(!!e.scal);xa();break;case "ftyp":e.ftyp?nd():dd()}}function Jc(a){a=$(this).attr("type")||this.type;var b=$(this).attr("id");"checkbox"==a&&(e[b]=$(this).prop("checked"));if("number"==a||"select-one"==a||"range"==
a)e[b]=$(this).val();Ea(b,1,1)}function re(){function a(a){$("#drpuse").prop("checked",!a);$("#drpuse").attr("disabled",a);$("#drplbl").css("color",a?"#aaa":"#000")}function b(){var a=$("#drpuse").prop("checked");$(".dropbox-dropin-btn").css("display",a?"inline-block":"none");$("#fknp").css("display",a?"none":"inline-block")}if("undefined"==typeof Dropbox){a(!0);var c;$.ajax({url:"https://www.dropbox.com/static/api/2/dropins.js",dataType:"script",cache:!0}).done(function(){a(!1);Dropbox.init({appKey:"ckknarypgq10318"});
c=Dropbox.createChooseButton({success:z,extensions:[".xml",".abc",".js"],cancel:function(){},linkType:"preview",multiselect:!1});$("#flbl").append(c);b()})}else b()}function Id(a){var b,c,d=0,e=-1,f=Math.floor(a.length/2),h=0,k=Infinity;Ha=Array(f);var n=f/2;for(c=3;c<f;c++){var l=0;var p=Math.floor(n-c/2);a[p]>h&&(h=a[p]);for(b=p;b<p+f;b++){var q=a[b]-a[b+c];l+=q*q}d+=l;l*=(c-2)/d;Ha[c]=l;if(l<k)k=l,e=c;else if(.1>k)break}c=Ha[e+1];b=Ha[e];a=Ha[e-1];return{period:e+((a-c)/(c-2*b+a)/2||0),diff:k,
max:h}}function Jd(a){Ga.getFloatTimeDomainData(Ya);var b=Id(Ya),c=b.period/a;c=1.06>c&&.94<c;if(b.diff<nb&&0<b.diff&&b.max>Kc||.65>b.diff&&c){var d=D.sampleRate/b.period;c||ra||(ra=Math.round(69+12*Math.log(d/440)/Math.log(2)),d=[144,ra,110],za({data:d}),console.log("micNote on:",ra,b.period.toFixed(2),b.diff.toFixed(2)));a=b.period}else ra&&(d=[144,ra,0],za({data:d}),console.log("micNote off",ra,c,b.diff.toFixed(2)),ra=0),a=1;Ob=setTimeout(function(){Jd(a)},0)}function Gd(){var a=parseInt(e.minlev),
b=2.5*(40+a),c=$("#mxlvl").width();$("#levmrk").css("width",c*b/100+"px");Kc=Math.pow(10,a/20);$("#mval").html(a)}function qe(){var a=parseFloat(e.drempel);nb=a/10;$("#dval").html(a);Kd()}function Fd(){var a=parseFloat(e.gain);ob&&(ob.gain.value=Math.pow(10,(a+1)/2-3));$("#gval").html(a)}function Hd(){Ga.fftSize=4*Xa;Ya=new Float32Array(Ga.frequencyBinCount)}function Ic(){pb&&(pb.getAudioTracks().forEach(function(a){a.stop()}),Lc.disconnect(),pb=null,cancelAnimationFrame(Pb),clearTimeout(Ob));$("#micuse").prop("checked",
!1);$("#micKnop").css("background","");$("#micon").css("color","#666")}function pe(){function a(a){pb=a;Lc=D.createMediaStreamSource(a);ob=D.createGain();Ga=D.createAnalyser();Hd();Lc.connect(ob);ob.connect(Ga);Fd();Ld();$("#micKnop").css("background","orange");$("#micon").css("color","#c33");Mb("delay",!1)}function b(a){alert("Can not access the microphone!\n"+a.name+": "+a.message);Ic()}if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)navigator.mediaDevices.getUserMedia({audio:!0}).then(a).catch(b);
else{navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia;try{navigator.getUserMedia({audio:!0},a,b)}catch(c){alert("getUserMedia() not supported by your browser -> no microphone\n"+c.name+": "+c.message),Ic()}}}function se(){var a=document.getElementById("micuse");e.micuse=a.checked=!a.checked;Ea("micuse",0)}function Ld(){pb&&(cancelAnimationFrame(Pb),clearTimeout(Ob),Md?Pb=requestAnimationFrame(function(){Nd(1)}):Ob=setTimeout(function(){Jd(1)},
0))}function Od(a){$("#tuner").toggle(a);a&&($("#micuse").focus(),Gd());Z&&ua();Md=a;Ld()}function Nd(a){var b=performance.now();Ga.getFloatTimeDomainData(Ya);var c=Id(Ya),d=c.period/a;a=1.06>d&&.94<d;d=69+12*Math.log(D.sampleRate/c.period/440)/Math.log(2);b=(performance.now()-b).toFixed(2);if(c.diff<nb&&0<c.diff&&c.max>Kc||.65>c.diff&&a){a=c.period;a=Math.round(d);var e=te[a%12]+Math.floor(a/12);Qb.innerHTML=e;d=Math.round(100*(d-a));Mc.push(d);Za+=(d-Mc.shift())/30;qb.innerHTML=Math.round(Za);0<=
Za?(qb.style.width="50%",Rb.style.width=Za+"%"):(qb.style.width=50+Za+"%",Rb.style.width=-Za+"%");$a.style.background="#cc0";Qb.style.background="#cc0"}else e="---",a=1,$a.style.background="orange",Qb.style.background="none";Kd();v.strokeStyle="green";v.beginPath();v.moveTo(0,256-128*Ha[0]);d=Xa/512;for(a=1;a<Xa;a+=d)v.lineTo(a/d,256-128*Ha[a]);v.stroke();v.beginPath();v.moveTo(c.period/d,256);v.strokeStyle="red";v.lineTo(c.period/d,245);v.stroke();c=20*Math.log10(c.max);Nc=2.5*(40+c);Nc>Sb?(Sb=Nc,
$a.innerHTML=c.toFixed(0),Tb=Ya.slice()):--Sb;$a.style.width=Sb+"%";b>Oc&&(Oc=b);20==Pd++&&(Ub.style.width=Math.min(10*b,100)+"%",Ub.innerHTML=b,Pd=Oc=0);if(Tb){v.strokeStyle="grey";v.beginPath();v.moveTo(0,128-32*Tb[0]);d=Xa/512;for(a=1;a<Xa;a+=d)v.lineTo(a/d,128-32*Tb[a]);v.stroke()}Pb=requestAnimationFrame(function(){Nd(1)})}function Kd(){v.clearRect(0,0,512,256);v.beginPath();v.moveTo(0,256-128*nb);v.strokeStyle="blue";v.setLineDash([5,3]);v.lineTo(512,256-128*nb);v.stroke();v.setLineDash([])}
function ue(){var a=document.body,b=a.requestFullscreen||a.mozRequestFullScreen||a.webkitRequestFullscreen,c=document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen;b&&c&&($("#fscr").prop("checked")?b.call(a):c.call(document))}function ve(){var a;navigator.bluetooth.requestDevice({filters:[{services:["03b80e5a-ede8-4b33-a751-6ce34ec4c700"]}]}).then(function(a){var b=a.gatt.connect();u("BLE Connected: "+a.name+", "+a.id.substring(0,5)+"...");return b}).then(function(a){return a.getPrimaryService("03b80e5a-ede8-4b33-a751-6ce34ec4c700")}).then(function(a){return a.getCharacteristic("7772e5db-3868-4112-a1a9-f2669d106bf3")}).then(function(b){a=
b;return a.startNotifications()}).then(function(b){u("Midi notifications started");a.addEventListener("characteristicvaluechanged",we)}).catch(function(a){u(a.toString())})}function we(a){var b=a.target.value.getUint8(2),c=a.target.value.getUint8(3);a=a.target.value.getUint8(4);za({data:[b,c,a]})}function R(a,b,c){c=void 0===c?1:c;b?($(a).toggle(!0),tb+=1,Ca.disabled=!0):($(a).toggle(!1),--tb,0==tb&&c&&(Ca.disabled=!1))}var ta={},n=[],q=0,M=-1,cc,cb,Cb,td=[],qa={},Ia,X=0,jb=0,nc,oc,vb=0,Z,S,ja=0,
Aa,hd=1,W=0,E,fb,kb,id,sc,fd,jd,gd,Ua,Pc,Ca,Gb,ca={},Ac={},ia=[],ba={},Sa={};M=[];var zb,Qd=$(document.createElementNS("http://www.w3.org/2000/svg","rect"));Qd.attr({id:"loper",fill:"#0dd","fill-opacity":.5,width:"0"});var G=Qd.get(0),va,Na,U=null,N,wa,D,Qc=[],Wb=[],Xb=0,rb={},Yb,Sc={},ac={};ta={};var bc={},K=[],la,ub=[],Ka=[],bb=[];var fa=[];var kc,Va=0,Db,Eb,I={},vc,wc,xc,yc,zc,qd,Ta,od,gc,Cc,H,L,mc,ed,lc,vd,V=0,Q,oa=0,Ab,aa={},eb,Kb={},Hb=0,ib=0,Yd,hb,qc,Hc=0,Ec={},$c={},Fc={},T=[],La=[],Ra=0,
Ad,ad={},Y=0,wb,Vc=0,x=0,pc,P,Wa=0,fc={},jc,lb=0,C,db,e,Md=0,Kc,ra=0,pb,Lc,Ga,Ya,ob,Ha,Ub,Oc=0,Pd=0,nb,v;var Xa=512;for(var $a,Nc=0,Sb=-100,Qb,Rb,qb,Za=0,Tb,Ob,Pb,te="C ;C#;D ;D#;E ;F ;F#;G ;G#;A ;A#;B ".split(";"),hc,bd,Mc=[],Pa=0;30>Pa;Pa++)Mc.push(0);var h={},Nb={delay:1,eenvoor:0,metro:0,keys:0,mark:0,mute:0,volgmod:6,chkmod:2,extract:1,portsel:"synth",tempo:60,kbopa:0,pw:0,scl:1,gain:5,drempel:1,minlev:-18,bass:0,mtpo:20,hrz:0,vol:50,nocur:0,rstmute:0,exact:0,nolyr:0,lus:0,lusstop:1,lncur:0,
tmng:0,tmng2:0,metmrk:0,ftyp:0,nocnt:0,scal:0,echo:1},Ed={staff:1,line:30,begin:0,btime:0,etime:0,ctrls:0,shrnk:0,lat:0,pnlerr:.5,pnltim:.5,oneclr:0,late1:150,late2:1E3,pnlkrt:.5,kort:30,minkort:200,atagTijd:-1,btagTijd:-1,audOn:!0,hide2cur:0,stopat:-1,hinfo:36,mat:.5,tmo:200,kleur:"#f9f #3cf #c99 #f66 #fc0 #cc0 #ccc".split(" "),ntGoed:"#080",ntFout:"#f00",ntWacht:"#0dd",ntKleur:"#f00 #ff0 #f00 #0bb #f00 #aaa #f00".split(" ")},Vb=2,ab,ec,tb=0,y,mb,na,xd,Qa,pa,Jb,Ja={},Ib=1,Da,Dc,Lb=0,Ba;$(document).ready(function(){y=
document.getElementById("aud");mb=document.getElementById("vol")||{addEventListener:function(){}};Ta=document.getElementById("perf");E=document.getElementById("notation");fb=CSS.supports("scroll-behavior","smooth");Ca=document.getElementById("start");$("#verlab").html("Version: "+follow_VERSION);$("body").keydown(Zd).click(function(){Z&&ua()});$("#perfbtn").click(function(a){a.stopPropagation();Ta.style.display="none"});Ta.addEventListener("click",function(a){a.stopPropagation()});$("#kwart").click(function(){e.metro=
1;$("#metro").prop("checked",1);J(-1)});$("#kwart").append($("#mtrsvg"));$("#tempo").change(function(){H=L.met/384*gc.value;e.tempo=H;yd()});$("#micon").click(se);$("#start").click(function(){J(-2)});$("#spkr").append($("#spkron"));$("#spkr").append($("#spkrof").toggle(!1));$("#spkr").toggle(!1).click(function(a){a.stopPropagation();wd(!e.audOn)});$("#menu").toggle(!1);Z=0;$("#menu").click(function(a){a.stopPropagation()});$("#mbar").click(function(a){a.stopPropagation();Bc(1)});$("#mbar2").click(function(a){a.stopPropagation();
Bc(2)});$("#mbar3").click(function(a){a.stopPropagation();Bc(3)});$("#menu select").change(Jc);$("#menu input").change(Jc);$("#tuner input").change(Jc);$("#zoom").on("mousedown touchstart",le);$("#rollijn").on("mousedown touchstart",oe);$("#info").on("mousedown touchstart",me);$(window).resize(function(){Wc();Xc();Fa();ka()});$("#fknp").change(da);$("#testport").on("mousedown",sd);$("#stats").click(function(){Xd(0)});$("#save").click(ge);$("#saveok").click(function(){$("#saveDlg").toggle()});$("#micKnop").click(function(){Od(!0)});
$("#ble").click(ve);$("#micOk").click(function(){Od(!1)});$a=document.querySelector("#mxlvl > div");$a.innerHTML="0";Rb=document.querySelector("#cents > div");Rb.innerHTML="&nbsp;";qb=document.querySelector("#cents > span");qb.style.width="50%";Qb=document.getElementById("noot");Ub=document.querySelector("#anatijd > div");Ub.innerHTML="0";v=document.getElementById("graaf").getContext("2d");Dd("#kblft");Dd("#kbrgt");od=$("#error")[0];gc=$("#tempo")[0];Cc=$("#path9868")[0];va=document.getElementById("atag");
va.style.display="none";Na=document.getElementById("btag");Na.style.display="none";Oa(1);var a=window.AudioContext||window.webkitAudioContext;(D=void 0!=a?new a:null)||alert("Your browser does not support the Web Audio API");Rc("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yE2S0tyZVivRopSXQGhTEhUhrKy7MrjXjaFIEjX//ppWN6hxW8rShnYym/ytlBCipejyoBI5S6sunmXcqS0CsGFKxqM5dAJ1IWRStJ30SS6VsMi1wsgexC7hVLmpVeu9iV0q2osru+oamEzp//PEZHUOIQ0hHz0iLhvZ7jl2YMsmXYCpYRlkySmBaQj0+Hk4LS3zlx2Werj37ZkxWrUwlPNdbe6sPUhxMpeTKURFUf63LMdjAKKm/apXob0KyG9TfmeVlDrWU+e//LNf//HNNCqQKKmRjTIsSNCyB7DAVImRZIxpoc00KpAoqZGVTEFNRTMuOTkuNVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUNrmJJJLQwNA8o//PEZAoFmAb2fwwjARIh1dGeMMSeWFU1inUzqFtbUf+sU/xfrb/9Yp/+tv/7P/xUW/+sUb/8VFgCV5cdsFABhJlxbOUVcJ48oIFUMmWUGEFkZNZ2UjWWzI+hgYME4g+wHY5DlMqIrfgjjOVP//ymVUXMFDKLB40FRRtQsK///8UVTEFNRTMuOTkuNVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV",
function(a){vd=a;console.log("E3 decoded")});hb=Hb?10:3;qc=1/hb;$("#err").text("");sb();"requestMIDIAccess"in navigator?navigator.requestMIDIAccess().then(be,ce):($("#notation").append('<br>Web MIDI API is not supported in this browser: try Chrome or Opera (on iOS you can try the <a href="https://apps.apple.com/us/app/web-midi-browser/id953846217">Web Midi Browser</a>)'),u('Web MIDI API is not supported in this browser: try Chrome or Opera (on iOS you can try the <a href="https://apps.apple.com/us/app/web-midi-browser/id953846217">Web Midi Browser</a>)'));
$("#ble").prop("disabled",!("bluetooth"in navigator));ee()||Zb();ke();$("#kwart").attr("title","Click here to start and keep the metronome on.\nFlashes and clicks on each beat. First beat extra loud");$("#tempo").attr("title","Tempo of the metronome in beats per minute (bpm)");$("#start").attr("title","Start/stop playing.");$("#micon").attr("title","Switches the microphone on/off.");$("#vol").attr("title","The volume of the internal synthesizer");$("#error").attr("title","Shows how correct you have played.\nReaches 100% at the end of a correctly played score.");
$("#l0").attr("title","Playback: plays the score and checks notes if you play them.\nConstant tempo: plays the score, but waits until you play the correct notes.\nAdaptive: Adapts the tempo to your playing. It can speed up or slow down (until the given minimum tempo).");$("#l1").attr("title","Select which staves you want to play (and checked while playing).");$("#flbl").attr("title","Load a score file from your local file system. (Or an audio file or a preload file.)");$("#drplbl").attr("title","Load the score file from your Dropbox.");
$("#l2").attr("title","Use internal synthesizer or MIDI interface or no sound at all.");$("#l3").attr("title","Also display a line cursor that\nmoves continuously. (with score time)");$("#l4").attr("title","Hide the normal note cursors.");$("#l5").attr("title","Restrict the play area with two loop marks.\nTo move a mark: first select then click new position");$("#stoplbl").attr("title","When end of loop is reached, stop playing\nand jump to loop begin.");$("#l6").attr("title","Display the score in one long line.\nThe line scrolls horizontally when playing.");
$("#pwlbl").attr("title","Sets the score page width in centimeters.\nZero resets to default.\nUseful to enlarge the score.");$("#scllbl").attr("title","Scale factor for side scrolling score.");$("#l7").attr("title","Keep the metronome ticking after the count-in.");$("#l8").attr("title","When the score has lyrics, hide it");$("#l9").attr("title","Do not synthesize the staff(s) you are playing yourself");$("#lA").attr("title","Only synthesize the staff(s) you are\nplaying yourself (and mute all others)");
$("#lB").attr("title","Show the on-screen keyboard.");$("#marklbl").attr("title","Show names of the notes highlighted by the cursors");$("#lC").attr("title","Only show the selected staff (part) from a concert score");$("#lD").attr("title","Connect to a MIDI device via Bluetooth LE.");$("#lE").attr("title","Show the advanced menu");$("#lF").attr("title","Show a graph of the performance\nThe timing errors of all played notes and a runnung average of 10 notes");$("#lG").attr("title","Check if notes are held down for the right duration.\nMark notes (orange) played too short (or long)");
$("#lH").attr("title","Check if notes are played at the right time.\nMark notes (gold) played too late.");$("#lI").attr("title","Show permanent error marks and timing marks");$("#lJ").attr("title","Start without count-in");$("#").attr("title","");$("#adv, .ext").toggle($("#advanced").prop("checked"));$("#advanced").on("change",function(){return $("#adv, .ext").toggle($("#advanced").prop("checked"))});$("#fscr").on("change",ue);$("body").on("fullscreenchange webkitfullscreenchange mozfullscreenchange",
function(){var a=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement;$("#fscr").prop("checked",null!=a)});E.addEventListener("touchstart",function(a){Pc=a.touches[0].clientX});E.addEventListener("touchmove",function(a){"stop"==Ca.value&&J(q);e.hrz&&(a.stopPropagation(),a.preventDefault(),E.scrollLeft-=a.touches[0].clientX-Pc,Pc=a.touches[0].clientX)})})})();
